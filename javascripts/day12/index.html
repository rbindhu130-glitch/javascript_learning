<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weather App</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom, #e0eafc, #cfdef3);
      /* Light neutral weather color */
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      transition: background 1s ease;
      overflow: hidden;
    }

    /* Dynamic Backgrounds */
    body.clear {
      background: linear-gradient(to bottom, #4facfe, #f093fb);
    }

    body.clouds {
      background: linear-gradient(to bottom, #bdc3c7, #2c3e50);
    }

    body.rain {
      background: linear-gradient(to bottom, #203a43, #2c5364);
    }

    .container {
      background: rgba(255, 255, 255, 0.95);
      padding: 30px;
      border-radius: 15px;
      text-align: center;
      width: 320px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      position: relative;
      z-index: 10;
    }

    /* Effects Styles */
    #effectsContainer {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    .cloud-svg {
      position: absolute;
      fill: white;
      opacity: 0.8;
      filter: blur(2px);
      animation: floatClouds linear infinite;
    }

    .sun {
      position: absolute;
      top: 100px;
      left: 80px;
      width: 100px;
      height: 100px;
      background: radial-gradient(circle, #ffd700, #ff8c00);
      border-radius: 50%;
      box-shadow: 0 0 50px #ffae00, 0 0 100px #ffd700;
      animation: pulseSun 3s ease-in-out infinite;
      z-index: 2;
    }

    @keyframes pulseSun {

      0%,
      100% {
        transform: scale(1);
        opacity: 0.9;
      }

      50% {
        transform: scale(1.1);
        opacity: 1;
      }
    }

    @keyframes floatClouds {
      from {
        transform: translateX(-150px);
      }

      to {
        transform: translateX(110vw);
      }
    }

    .drop {
      position: absolute;
      background: rgba(255, 255, 255, 0.4);
      width: 2px;
      height: 15px;
      top: -20px;
      animation: fall linear infinite;
    }

    @keyframes fall {
      to {
        transform: translateY(100vh);
      }
    }

    h2 {
      margin-bottom: 15px;
    }

    input {
      padding: 8px;
      width: 70%;
      margin-bottom: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    button {
      padding: 8px 12px;
      background: #4facfe;
      border: none;
      color: white;
      cursor: pointer;
      border-radius: 5px;
    }

    button:hover {
      background: #007bff;
    }

    .weather-box {
      margin-top: 15px;
      display: none;
    }

    .weather-box.active {
      display: block;
    }

    .error {
      color: red;
      margin-top: 10px;
      min-height: 20px;
    }
  </style>
</head>

<body>
  <div id="effectsContainer"></div>

  <div class="container">
    <h2>ðŸŒ¦ Weather App</h2>
    <input type="text" id="city" placeholder="Enter city name">
    <br>
    <button onclick="getWeather()">Search</button>
    <p class="error" id="error"></p>

    <div class="weather-box" id="weatherContent">
      <h3 id="cityName"></h3>
      <p id="temp"></p>
      <p id="desc"></p>
      <p id="humidity"></p>
      <p id="wind"></p>
    </div>
  </div>

  <script>
    async function getWeather() {
      const city = document.getElementById("city").value.trim();
      const errorElement = document.getElementById("error");
      const weatherContent = document.getElementById("weatherContent");

      errorElement.innerText = "";

      if (city === "") {
        errorElement.innerText = "Please enter a city name";
        weatherContent.classList.remove("active");
        return;
      }

      const url = `http://localhost:3000/weather?city=${city}`;

      try {
        const response = await fetch(url);
        const data = await response.json();

        if (data.cod !== 200) {
          errorElement.innerText = "City not found!";
          weatherContent.classList.remove("active");
          return;
        }

        // Populate data
        document.getElementById("cityName").innerText = data.name;
        document.getElementById("temp").innerText = `ðŸŒ¡ Temperature: ${Math.round(data.main.temp)}Â°C`;
        document.getElementById("desc").innerText = `ðŸŒ¥ Condition: ${data.weather[0].description}`;
        document.getElementById("humidity").innerText = `ðŸ’§ Humidity: ${data.main.humidity}%`;
        document.getElementById("wind").innerText = `ðŸŒ¬ Wind: ${data.wind.speed} km/h`;

        // Show box
        weatherContent.classList.add("active");

        // Dynamic Effects
        updateEffects(data.weather[0].main.toLowerCase());

      } catch (error) {
        errorElement.innerText = "Error fetching data!";
        weatherContent.classList.remove("active");
        updateEffects('default');
      }
    }

    function updateEffects(condition) {
      const body = document.body;
      const container = document.getElementById('effectsContainer');
      container.innerHTML = ''; // Reset effects
      body.className = ''; // Reset background

      if (condition.includes('clear')) {
        body.classList.add('clear');
        addSun(); // Adding the Sun
        addClouds(3, 0.4); // Adding light Clouds
      } else if (condition.includes('cloud')) {
        body.classList.add('clouds');
        addClouds(8, 0.7); // More, denser clouds
      } else if (condition.includes('rain')) {
        body.classList.add('rain');
        addRain();
      }
    }

    function addSun() {
      const container = document.getElementById('effectsContainer');
      const sun = document.createElement('div');
      sun.classList.add('sun');
      container.appendChild(sun);
    }

    function addClouds(count, opacity) {
      const container = document.getElementById('effectsContainer');
      for (let i = 0; i < count; i++) {
        const cloud = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        cloud.setAttribute("viewBox", "0 0 24 24");
        cloud.classList.add("cloud-svg");
        cloud.style.width = (Math.random() * 100 + 100) + "px";
        cloud.style.top = (Math.random() * 40) + "vh";
        cloud.style.animationDuration = (Math.random() * 20 + 20) + "s";
        cloud.style.animationDelay = (Math.random() * -40) + "s";
        cloud.style.opacity = opacity;

        cloud.innerHTML = '<path d="M17.5,19c-3,0-5.5-2.5-5.5-5.5c0-0.4,0-0.8,0.1-1.2C10.8,12.1,9.4,11.5,8,11.5c-2.5,0-4.5,2-4.5,4.5s2,4.5,4.5,4.5h9.5 c1.4,0,2.5-1.1,2.5-2.5S18.9,15.5,17.5,15.5c-0.2,0-0.4,0-0.6,0.1c0.3-0.6,0.5-1.3,0.5-2.1c0-2.5-2-4.5-4.5-4.5 c-1.5,0-2.8,0.7-3.6,1.8C9,10.3,8.5,10,8,10c-2.2,0-4,1.8-4,4c0,0.2,0,0.4,0,0.7C2,15.4,1,17.1,1,19c0,2.8,2.2,5,5,5h11.5 c2.5,0,4.5-2,4.5-4.5S20,15,17.5,15c-0.2,0-0.4,0-0.6,0.1c0.1-0.2,0.1-0.4,0.1-0.6c0-2.8-2.2-5-5-5c-1.4,0-2.7,0.6-3.6,1.5 c-0.8-1-2.1-1.5-3.4-1.5c-2.5,0-4.5,2-4.5,4.5c0,0.4,0.1,0.8,0.2,1.2C1.9,16.1,1,17.4,1,19c0,2.2,1.8,4,4,4h12.5 c1.9,0,3.5-1.6,3.5-3.5S19.4,16,17.5,16L17.5,19z"/>';

        container.appendChild(cloud);
      }
    }

    function addRain() {
      const container = document.getElementById('effectsContainer');
      for (let i = 0; i < 80; i++) {
        const drop = document.createElement('div');
        drop.classList.add('drop');
        drop.style.left = Math.random() * 100 + 'vw';
        drop.style.top = Math.random() * -100 + 'vh';
        drop.style.animationDuration = (Math.random() * 0.5 + 0.5) + 's';
        drop.style.animationDelay = (Math.random() * 2) + 's';
        container.appendChild(drop);
      }
    }
  </script>

</body>

</html>